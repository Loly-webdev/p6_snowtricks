{% extends 'base.html.twig' %}
{% block title %}Modification d'une figure{% endblock %}
{% form_theme form _self %}
{% block content %}
    <section class="edit-trick container mt-4 text-center" id="edit">
        <div class="edit-trick-title">
            <h2>Modification de la figure :
                <strong class="text-primary">{{ trick.name }}</strong>
            </h2>
        </div>
        <div class="edit-trick-content-details text-muted mt-3">
            <em>Date de création :
                {{ trick.createdAt|date("d/m/Y") }}</em>
            <br>
            <em>Date de modification :
                {{ trick.updatedAt|date("d/m/Y") }}</em>
        </div>
        <div class="edit-trick-content mt-3 mb-5 border p-3">
            {% if trick.pictures is not empty %}
            <div class="edit-trick-content-picture-title">
                <h3 class="mx-auto border-bottom border-top w-50">Photos</h3>
            </div>
            <div class="edit-trick-content-picture">
                {% for picture in trick.pictures %}
                {% set edit_picture_url = path('trick_edit_picture', {id: picture.id}) %}
                {% if loop.first %}
                <div class="card h-100">
                    <figure class="edit-trick-content-picture-featured card-img-top text-center ">
                        <figcaption class="card-header">
                            {{ picture.caption }}
                        </figcaption>
                        <img class="img-fluid"
                             src="{{ asset('uploads/pictures/' ~ picture.path) }}"
                             alt="">
                    </figure>
                    {% endif %}
                    {% endfor %}
                </div>
                {% endif %}
                <div class="edit-trick-content-more">
                    <input type="checkbox" hidden class="edit-trick-content-more-state" id="read-more">
                    <div class="edit-trick-content-more-target">
                        {{ form_start(form, { "attr": { "class": "edit-trick-content-form"} }) }}
                        <div class="edit-trick-content-picture-thumbnail row row-cols-1 row-cols-md-3">
                            {% for picture in trick.pictures %}
                                {% set edit_picture_url = path('trick_edit_picture', {id: picture.id}) %}
                                {% if not loop.first %}
                                    <div class="col my-4">
                                        <div class="card h-100">
                                            <figure class="edit-trick-content-picture-thumbnail-figure card-img-top text-center">
                                                <figcaption class="card-header">
                                                    {{ picture.caption }}
                                                </figcaption>
                                                <img src="{{ asset('uploads/pictures/' ~ picture.path) }}"
                                                     class="img-fluid"
                                                     width="200"
                                                     alt="">
                                            </figure>
                                        </div>
                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                        {{ form_row(form.pictures) }}
                        <div class="edit-trick-content-video">
                            <div class="edit-trick-content-video-title">
                                <h3 class="mx-auto mt-5 border-bottom border-top w-50">Vidéos</h3>
                            </div>
                            {% if trick.videos is not empty %}
                            <div class="edit-trick-content-video-thumbnail row row-cols-1 row-cols-md-3">
                                {% for video in trick.videos %}
                                    <div class="col my-4">
                                        <div class="card h-100">
                                            <div class="edit-trick-content-video-thumbnail-card card-img-top text-center ">
                                                <iframe width="200" height="150" src="{{ video.url }}"
                                                        allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
                                                        allowfullscreen></iframe>
                                            </div>
                                            <div class="card-body">
                                                <p>URL :
                                                    <a href="{{ video.url }}" class="card-title">
                                                        {{ video.url }}
                                                    </a>
                                                </p>
                                            </div>
                                            <div class="card-footer">
                                                <div class="edit-trick-content-video-thumbnail-card-icon">
                                                    <a href="" class="btn-delete-video btn btn-danger" type="button"
                                                       onclick="return confirm('Etes-vous sûr ?');">
                                                        <span class="fas fa-trash-alt"></span>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                        {% endif %}
                        {{ form_row(form.videos) }}
                    </div>
                    <label for="read-more" class="edit-trick-content-more-trigger_closed btn">Voir plus</label>
                    <label for="read-more" class="edit-trick-content-more-trigger_opened btn">Voir Moins</label>
                </div>
                {{ form_row(form.name) }}
                {{ form_row(form.category) }}
                {{ form_row(form.description) }}
                <button type="submit" class="btn btn-success mt-3">Valider</button>
                {{ form_end(form) }}
            </div>
        </div>
    </section>
    <div class="text-center mt-3">
        <a href="{{ path('home') }}" type="button" class="btn-add-picture btn btn-info">
            <span class="fas fa-angle-double-left"></span>
            Retour à la liste des figures
        </a>
    </div>
{% endblock %}
{% block form_row %}
    <div class="edit-trick-content-form-row bg-light container h-auto p-5 my-3 mx-auto">
        <label class="font-weight-bold text-info">
            {{ form_label(form) }}
        </label>
        {{ form_widget(form) }}
        <div class="edit-trick-content-form-error">
            {{ form_errors(form) }}
        </div>
    </div>
{% endblock %}
{% block _trick_pictures_row %}
    {{ form_widget(form) }}
    <button type="button" class="btn-add-picture btn btn-primary mb-3" id="add_picture">
        Ajouter une autre photo
    </button>
{% endblock %}
{% block _trick_pictures_entry_widget %}
    <div class="modal-none">
        <div class="edit-trick-content-form-entry">
            <span class="fas fa-edit"></span>
            {{ form_label(form.caption) }}
            {{ form_widget(form.caption) }}
            <div class="edit-trick-content-form-error">
                {{ form_errors(form.caption) }}
            </div>
        </div>
    </div>
{% endblock %}
{% block _trick_videos_row %}
    {{ form_widget(form) }}
    <button type="button" class="btn-add-video btn btn-primary mb-3" id="add_video">
        Ajouter une autre vidéo
    </button>
{% endblock %}{% block _trick_videos_entry_widget %}
    <div class="modal-none">
        <div class="edit-trick-content-form-entry">
            <span class="fas fa-edit"></span>
            {{ form_label(form.name) }}
            {{ form_widget(form.name) }}
            <div class="edit-trick-content-form-error">
                {{ form_errors(form.name) }}
            </div>
        </div>
    </div>
{% endblock %}
